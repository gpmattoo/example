<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>9.&nbsp;Configuring the Virgo Web Server</title><link rel="stylesheet" href="css/stylesheet.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.74.0"><link rel="home" href="index.html" title="Virgo Web Server User Guide"><link rel="up" href="index.html" title="Virgo Web Server User Guide"><link rel="prev" href="ch08s02.html" title="8.2&nbsp;Undeploying Artifacts"><link rel="next" href="ch09s02.html" title="9.2&nbsp;Configuring Serviceability"><!--Begin Google Analytics code--><script type="text/javascript">
			var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
			document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
		</script><script type="text/javascript">
			var pageTracker = _gat._getTracker("UA-2728886-3");
			pageTracker._setDomainName("none");
			pageTracker._setAllowLinker(true);
			pageTracker._trackPageview();
		</script><!--End Google Analytics code--></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">9.&nbsp;Configuring the Virgo Web Server</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch08s02.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ch09s02.html">Next</a></td></tr></table><hr></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="configuring"></a>9.&nbsp;Configuring the Virgo Web Server</h2></div></div></div><p>You use configuration files in the <code class="literal">$SERVER_HOME/config</code> directory to configure VWS.   This section divides the configuration of the server into the following high-level tasks:</p><div class="itemizedlist"><ul type="disc"><li><a class="link" href="ch09.html#configuring-kernel" title="9.1&nbsp;Configuring the Virgo Kernel and User Region">Configuring the kernel and the user region.</a></li><li><a class="link" href="ch09s03.html" title="9.3&nbsp;Configuring the Embedded Tomcat Servlet Container">Configuring embedded Tomcat servlet container.</a></li><li><a class="link" href="ch09s02.html" title="9.2&nbsp;Configuring Serviceability">Configuring serviceability.</a></li><li><a class="link" href="ch09s04.html" title="9.4&nbsp;Configuring the Local Provisioning Repository">Configuring the local provisioning repository.</a></li><li><a class="link" href="ch09s05.html" title="9.5&nbsp;Configuring a Hosted Repository">Configuring the hosted repository.</a></li></ul></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configuring-kernel"></a>9.1&nbsp;Configuring the Virgo Kernel and User Region</h2></div></div></div><p>This section provides information about configuring the VWS kernel and the user region by updating the following files in the <code class="literal">$SERVER_HOME/config</code> directory:</p><div class="table"><a name="configuring-kernel-table"></a><p class="title"><b>Table&nbsp;9.1.&nbsp;Kernel Configuration Files </b></p><div class="table-contents"><table summary="Kernel Configuration Files " style="border-collapse: collapse;border-top: 1.0pt solid ; border-bottom: 1.0pt solid ; border-left: 1.0pt solid ; border-right: 1.0pt solid ; "><colgroup><col><col></colgroup><thead><tr><th style="border-right: 1.0pt solid ; border-bottom: 1.0pt solid ; ">Property File</th><th style="border-bottom: 1.0pt solid ; ">Description</th></tr></thead><tbody><tr><td style="border-right: 1.0pt solid ; border-bottom: 1.0pt solid ; "><code class="literal">org.eclipse.virgo.kernel.properties</code></td><td style="border-bottom: 1.0pt solid ; ">Configures <a class="link" href="ch09.html#configuring-deployment" title="Configuring Deployment">kernel deployment</a> and the <a class="link" href="ch09.html#configuring-admin-shell" title="Configuring the Admin Shell">Admin Shell</a> of VWS. </td></tr><tr><td style="border-right: 1.0pt solid ; border-bottom: 1.0pt solid ; "><code class="literal">org.eclipse.virgo.kernel.userregion.properties</code></td><td style="border-bottom: 1.0pt solid ; ">Configures the <a class="link" href="ch09.html#configuring-user-region" title="Configuring the User Region">user region</a> of VWS.</td></tr><tr><td style="border-right: 1.0pt solid ; border-bottom: 1.0pt solid ; "><code class="literal">org.eclipse.virgo.kernel.users.properties</code></td><td style="border-bottom: 1.0pt solid ; ">Configures the <a class="link" href="ch09.html#configuring-authentication" title="Configuring Authentication">users that are allowed to access</a> the Admin Shell and Admin Console, and roles to which they map. </td></tr><tr><td style="border-right: 1.0pt solid ; border-bottom: 1.0pt solid ; "><code class="literal">org.eclipse.virgo.kernel.jmxremote.access.properties</code></td><td style="border-bottom: 1.0pt solid ; ">Configures the <a class="link" href="ch09.html#configuring-authentication" title="Configuring Authentication">permissions for users</a> that are allowed to access the Admin Shell and Admin Console. </td></tr><tr><td style="border-right: 1.0pt solid ; "><code class="literal">org.eclipse.virgo.kernel.authentication.config</code></td><td style="">Configures the <a class="link" href="ch09.html#configuring-authentication" title="Configuring Authentication">Java Authentication and Authorization Service (JAAS)</a> for the Tomcat server users.</td></tr></tbody></table></div></div><br class="table-break"><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="configuring-deployment"></a>Configuring Deployment</h3></div></div></div><p>You can configure three properties of deployment: the pickup directory into which you copy applications for hot-deployment, the deployment timeout, and whether automatic cloning of deployed bundles is enabled.  </p><p>To change any of these properties, edit the <code class="literal">deployer.XXX</code> properties of the <code class="literal">$SERVER_HOME/config/org.eclipse.virgo.kernel.properties</code> file.  The following table describes these properties.  </p><div class="table"><a name="configuring-deployment-table"></a><p class="title"><b>Table&nbsp;9.2.&nbsp;Deployment Configuration Properties</b></p><div class="table-contents"><table summary="Deployment Configuration Properties" style="border-collapse: collapse;border-top: 1.0pt solid ; border-bottom: 1.0pt solid ; border-left: 1.0pt solid ; border-right: 1.0pt solid ; "><colgroup><col><col></colgroup><thead><tr><th style="border-right: 1.0pt solid ; border-bottom: 1.0pt solid ; ">Property</th><th style="border-bottom: 1.0pt solid ; ">Description</th></tr></thead><tbody><tr><td style="border-right: 1.0pt solid ; border-bottom: 1.0pt solid ; "><code class="literal">deployer.timeout</code></td><td style="border-bottom: 1.0pt solid ; ">Specifies the amount of time, in seconds, after which VWS times out while trying to deploy a bundle, library, or plan.  The default value is <code class="literal">300</code>.  If you want to disable deployment timeout, specify <code class="literal">0</code>.</td></tr><tr><td style="border-right: 1.0pt solid ; "><code class="literal">deployer.pickupDirectory</code></td><td style="">Specifies the absolute or relative path to the pickup directory to which you copy applications for hot-deployment.  Relative paths are relative to <code class="literal">$SERVER_HOME</code>.  The default value is <code class="literal">./target/pickup.</code>.</td></tr></tbody></table></div></div><br class="table-break"><p>The following listing displays the default configuration distributed with the VWS; only relevant sections of the <code class="literal">org.eclipse.virgo.kernel.properties</code> file are shown. </p><pre class="programlisting">deployer.timeout=300
deployer.pickupDirectory=pickup</pre><p>As the default configuration shows, the default pickup directory is <code class="literal">$SERVER_HOME/pickup</code> and the deployment timeout is 300 seconds. 
		</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="configuring-admin-shell"></a>Configuring the Admin Shell</h3></div></div></div><p>
			The Admin Shell is a command line utility that allows you to examine artifacts currently installed to a particular Web Server instance, manage the lifecycle of the installed artifacts, install new artifacts, and shutdown the server.  For complete documentation on the Admin Shell, see <a class="xref" href="ch04.html" title="4.&nbsp;Equinox Console Extension">Chapter&nbsp;4, <i>Equinox Console Extension</i></a>.
		</p><p>
			You configure the Admin Shell by updating the <code class="literal">shell.XXX</code> properties in the <code class="literal">$SERVER_HOME/config/org.eclipse.virgo.kernel.properties</code> file, as described in the following table:
		</p><div class="table"><a name="configuring-admin-shell-table"></a><p class="title"><b>Table&nbsp;9.3.&nbsp;Admin Shell Configuration Properties</b></p><div class="table-contents"><table summary="Admin Shell Configuration Properties" style="border-collapse: collapse;border-top: 1.0pt solid ; border-bottom: 1.0pt solid ; border-left: 1.0pt solid ; border-right: 1.0pt solid ; "><colgroup><col><col></colgroup><thead><tr><th style="border-right: 1.0pt solid ; border-bottom: 1.0pt solid ; ">Property</th><th style="border-bottom: 1.0pt solid ; ">Description</th></tr></thead><tbody><tr><td style="border-right: 1.0pt solid ; border-bottom: 1.0pt solid ; "><code class="literal">shell.enabled</code></td><td style="border-bottom: 1.0pt solid ; ">Specifies whether the Admin Shell is enabled or not.  Valid values are <code class="literal">true</code> or <code class="literal">false</code>.</td></tr><tr><td style="border-right: 1.0pt solid ; "><code class="literal">shell.port</code></td><td style="">Defines the port on which you can remotely access the Admin Shell. If not set, the shell is only available from stdout of the VWS process.</td></tr></tbody></table></div></div><br class="table-break"><p>The following example shows the default Admin Shell configuration in a freshly-installed <code class="literal">org.eclipse.virgo.kernel.properties</code> file; only the relevant section of the file is shown. </p><pre class="programlisting">shell.enabled=true
shell.port=2401</pre><p>The example shows that the Admin Shell is enabled by default, and you connect to it remotely using the port <code class="literal">2401</code>.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="configuring-user-region"></a>Configuring the User Region</h3></div></div></div><p>The user region is the subsystem of VWS that supports deployed applications, both your own user applications and those of the server itself, such as the Admin Console.  The user region is deliberately isolated from the kernel, which makes it much simpler for you to manage your applications with the Admin Console or Admin Shell because the internal server bundles are not visible.  </p><p>
			You configure the user region by updating properties in the <code class="literal">$SERVER_HOME/config/org.eclipse.virgo.kernel.userregion.properties</code> file; these properties are described in the following table.  
		</p><p>
			<span class="bold"><strong>WARNING:</strong></span> We strongly recommends that you update only the <code class="literal">initialArtifacts</code> property; updating the other properties could cause VWS to fail.  These properties are documented for your information only.
		</p><div class="table"><a name="configuring-user-region-table"></a><p class="title"><b>Table&nbsp;9.4.&nbsp;User Region Configuration Properties</b></p><div class="table-contents"><table summary="User Region Configuration Properties" style="border-collapse: collapse;border-top: 1.0pt solid ; border-bottom: 1.0pt solid ; border-left: 1.0pt solid ; border-right: 1.0pt solid ; "><colgroup><col><col></colgroup><thead><tr><th style="border-right: 1.0pt solid ; border-bottom: 1.0pt solid ; ">Property</th><th style="border-bottom: 1.0pt solid ; ">Description</th></tr></thead><tbody><tr><td style="border-right: 1.0pt solid ; border-bottom: 1.0pt solid ; "><code class="literal">baseBundles</code></td><td style="border-bottom: 1.0pt solid ; ">Specifies the hard-coded list of bundles that VWS installs directly into the user region. Virgo Web Server does not perform any automatic dependency satisfaction for these bundles; in other words, you only get the bundles in the list and nothing more. </td></tr><tr><td style="border-right: 1.0pt solid ; border-bottom: 1.0pt solid ; "><code class="literal">packageImports</code></td><td style="border-bottom: 1.0pt solid ; ">Specifies the packages that exist in the kernel that VWS imports into the user region so that they are in turn available to be imported by bundles in the user region. This property supports a <code class="literal">.*</code> wildcard.  For example, <code class="literal">com.springsource.util.*</code> will import all packages that start with <code class="literal">com.springsource.util</code>.</td></tr><tr><td style="border-right: 1.0pt solid ; border-bottom: 1.0pt solid ; "><code class="literal">serviceImports</code></td><td style="border-bottom: 1.0pt solid ; ">Specifies the services in the kernel that are imported into the user region so that they're available to bundles in the user region.  </td></tr><tr><td style="border-right: 1.0pt solid ; border-bottom: 1.0pt solid ; "><code class="literal">serviceExports</code></td><td style="border-bottom: 1.0pt solid ; ">Specifies the services in the user region that are imported into the kernel so that they're available to bundles in the kernel.  </td></tr><tr><td style="border-right: 1.0pt solid ; border-bottom: 1.0pt solid ; "><code class="literal">inheritedFrameworkProperties</code></td><td style="border-bottom: 1.0pt solid ; ">Specifies the framework properties, configured in the <code class="literal">$SERVER_HOME/lib/org.eclipse.virgo.kernel.launch.properties</code> file, that will also be set on the user region's nested framework.</td></tr><tr><td style="border-right: 1.0pt solid ; "><code class="literal">initialArtifacts</code></td><td style="">Specifies the artifacts that VWS deploys into the user region when the server starts. Virgo Web Server performs dependency satisfaction when it deploys these artifacts.  This means that you only need to list the top-level artifacts that you care about; VWS automatically installs any other artifacts upon which they depend from the repository.
				<p>You can use this property to convert a VWS into a Virgo Kernel by removing the <code class="literal">repository:plan/org.eclipse.virgo.server.web</code> plan.  </p>
				</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="configuring-authentication"></a>Configuring Authentication</h3></div></div></div><p>Virgo Web Server uses the <a class="ulink" href="http://java.sun.com/javase/6/docs/technotes/guides/security/jaas/JAASRefGuide.html" target="_top">Java Authentication and Authorization Service (JAAS)</a> framework to authenticate the administration user that connects to Web Servers using the Admin Console or Admin Shell. This section describes how the authentication mechanism is configured by default, and the files that you need to update if you want to change the administration user, change their password,  and so on. </p><p>The <code class="literal">$SERVER_HOME/config/org.eclipse.virgo.kernel.authentication.config</code> file configures the underlying authentication technology for VWS.  The short file consists of the following entry:</p><pre class="programlisting">dm-kernel {
        org.eclipse.virgo.kernel.authentication.KernelLoginModule REQUIRED;
};</pre><p>The entry is named <code class="literal">dm-kernel</code>.  This name corresponds to the <code class="literal">&lt;Realm&gt;</code> element in the <code class="literal">$SERVER_HOME/config/tomcat-server.xml</code> file that configures the JAAS authentication mechanism for the <code class="literal">Catalina</code> service of the <a class="link" href="ch09s03.html" title="9.3&nbsp;Configuring the Embedded Tomcat Servlet Container">Tomcat servlet container</a>.  The <code class="literal">dm-kernel</code> entry specifies that the JAAS LoginModule that VWS uses to authenticate users is <code class="literal">org.eclipse.virgo.kernel.authentication.KernelLoginModule</code> and that this <code class="literal">KernelLoginModule</code> is required to "succeed" in order for authentication to be considered successful. The <code class="literal">KernelLoginModule</code> succeeds only if the name and password supplied by the user are the ones it expects.  The default administration username/password pair for Web Server is <code class="literal">admin/springsource</code>. </p><p>You configure the administration user in the <code class="literal">org.eclipse.virgo.kernel.users.properties</code> file.  The default file for a freshly installed VWS is as follows:</p><pre class="programlisting">##################
# User definitions
##################
user.admin=springsource

##################
# Role definitions
##################
role.admin=admin</pre><p>The administration user that connect to the Admin Console and Admin Shell must have the <code class="literal">admin</code> role.  The preceding file shows how, by default, the <code class="literal">admin</code> role is assigned the <code class="literal">admin</code> user with password <code class="literal">springsource</code>.</p><p>If you want to change the administration user, update the <code class="literal">org.eclipse.virgo.kernel.users.properties</code> file.  For example, if you want the <code class="literal">juliet</code> user, with password <code class="literal">supersecret</code>, to be the new adminstration user, update the file as shown:</p><pre class="programlisting">##################
# User definitions
##################
user.juliet=supersecret

##################
# Role definitions
##################
role.admin=juliet</pre><p>Be sure to restart VWS after you make this change for it to take effect.</p><p>The final file involved in VWS authentication is <code class="literal">$SERVER_HOME/config/org.eclipse.virgo.kernel.jmxremote.access.properties</code>.  This file specifies the JMX access privileges that the administration user has; by default they are read and write, as shown in the following listing:</p><pre class="programlisting">admin=readwrite</pre><p>The only other value you can enter is <code class="literal">readonly</code>, which means that the adminstration user would only be able to view information using the Admin Console and Admin Shell.</p></div></div></div><!--Begin LoopFuse code--><script src="http://loopfuse.net/webrecorder/js/listen.js" type="text/javascript"></script><script type="text/javascript">
			_lf_cid = "LF_48be82fa";
			_lf_remora();
		</script><!--End LoopFuse code--><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch08s02.html">Prev</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ch09s02.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">8.2&nbsp;Undeploying Artifacts&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;9.2&nbsp;Configuring Serviceability</td></tr></table></div></body></html>
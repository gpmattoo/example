package com.example;
import grails.test.*

class QueryIntegrationTests extends GrailsUnitTestCase {
	
    protected void setUp() {
        super.setUp()
    }

    protected void tearDown() {
        super.tearDown()
    }

    void testBasicDynamicFinders() {
    	new User(userId:'glen', password:'secret', profile: new Profile(email:'glen@glensmith.com')).save(flush:true)
    	
    	new User(userId:'peter', password:'sesame', profile:new Profile(homepage:'http://peter.com/')).save(flush:true)

    	def user = User.findByPassword('sesame')
    	assertEquals 'peter', user.userId

    	user = User.findByUserIdAndPassword('glen', 'secret')
    	assertEquals 'glen', user.userId

    	def now = new Date()
    	def users = User.findAllByDateCreatedBetween(now-1, now)
    	assertEquals 2, users.size()

    	def profiles = Profile.findAllByEmailIsNotNull()
    	assertEquals 1, profiles.size()
    }
}
